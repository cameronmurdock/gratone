<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ONE Local Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
  <script src="https://unpkg.com/@mui/material@5.11.0/umd/material-ui.development.js" crossorigin></script>
  <script src="https://unpkg.com/@mui/icons-material@5.11.0/umd/material-ui-icons.development.js" crossorigin></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,700|Playfair+Display&display=swap">

  <style>
    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      color: #333; /* Use consistent text color */
    }
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .MuiAppBar-root {
      background: rgba(255, 255, 255, 0.95) !important; /* Override default background */
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    }
    .map-container {
      height: 100%;
      border-radius: theme.shape.borderRadius;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const {
      AppBar, Toolbar, Typography, Box, Grid, Avatar, Tabs, Tab,
      List, ListItem, ListItemAvatar, ListItemText, Divider,
      Card, CardContent, CardActions, Button, IconButton, Modal, Fade, Backdrop, Icon, TextField
    } = MaterialUI;

    // ... (rest of Material UI component imports)

     // Custom Theme (Consistent with your org page)
    const theme = createTheme({ /* ... your theme object */});

    function App() {
      // ... (state and other variables)

      return (
        <ThemeProvider theme={theme}>
        <Box sx={{ display: 'flex', flexDirection: 'column', minHeight: '100vh'}}> {/* Ensure content takes up full viewport height */}
          <AppBar position="static">
            <Toolbar>
              <Typography variant="h6" component="div" sx={{ flexGrow: 1 }}>
                ONE Global
              </Typography>
              <TextField label="Search" variant="outlined" size="small" value={searchText} onChange={(e) => setSearchText(e.target.value)}  sx={{ backgroundColor: '#fff', mr: 2, borderRadius: '20px' }} InputLabelProps={{ shrink: true, style: { color: theme.palette.primary.main } }}
                InputProps={{ style: { color: theme.palette.primary.main } }}/>
              <IconButton color="inherit">
                <Avatar alt="User Avatar" src="https://randomuser.me/api/portraits/men/75.jpg" />
              </IconButton>
            </Toolbar>
          </AppBar>
          <Box sx={{ flexGrow: 1, overflow: 'hidden', display: 'flex' }}> {/* Flex container for avatars, tabs and content */}
            <Box sx={{ backgroundColor: theme.palette.background.default, padding: theme.spacing(2) }}>
              <Typography variant="h5" sx={{ fontWeight: 'bold', mb: 2 }}>Chats</Typography>
              <List>
                <ListItem button>
                  <ListItemAvatar>
                    <Avatar alt="Working Group" />
                  </ListItemAvatar>
                  <ListItemText primary="Working Group" secondary="Last message..." />
                </ListItem>
                <ListItem button>
                  <ListItemAvatar>
                    <Avatar alt="Sales" />
                  </ListItemAvatar>
                  <ListItemText primary="Sales" secondary="New idea..." />
                </ListItem>
              </List>
            </Box>

            <Box sx={{ flex: '1 1 auto', padding: theme.spacing(2), overflowY: 'auto' }}> {/* Make main content area scrollable */}
              <Tabs value={activeTab} onChange={(e, newValue) => setActiveTab(newValue)} centered>
                {Object.keys(allPosts).map(tab => (
                  <Tab key={tab} label={tab} value={tab} />
                ))}
              </Tabs>
              <Divider />
              <Box mt={3}>
                {filteredPosts.map(post => (
                  <Card key={post.id} sx={{ mb: 2 }} onClick={() => openModal(post)}>
                    <CardContent>
                      <Box sx={{ display: 'flex', alignItems: 'center' }}>
                        <Avatar alt={post.user} src={post.avatar} sx={{ mr: 2 }} />
                        <Typography variant="subtitle1">{post.user}</Typography>
                        <Typography variant="body2" color="textSecondary" sx={{ ml: 'auto' }}>{post.date}</Typography>
                      </Box>
                      <Typography variant="body1" paragraph>{post.content}</Typography>
                    </CardContent>
                  </Card>
                ))}
              </Box>
            </Box>
            <Box sx={{ backgroundColor: theme.palette.background.default, padding: theme.spacing(2), width: 300, minWidth: 300 }}>
              <Typography variant="h5" sx={{ fontWeight: 'bold', mb: 2 }}>Map</Typography>
              <Box className="map-container">{/* Replace with actual map implementation */}</Box> {/* Map placeholder */}
            </Box>
          </Box>

          {/* Modal */}
          <Modal
            open={selectedPost !== null} // Use selectedPost directly in condition
            onClose={closeModal}
            closeAfterTransition
            BackdropComponent={Backdrop}
            BackdropProps={{ timeout: 500 }}
          >
            <Fade in={selectedPost !== null}>
              <Box className="modalContent">
                {selectedPost && (
                  <>
                  <IconButton aria-label="close" onClick={closeModal} sx={{ position: 'absolute', top: 8, right: 8 }} >
                    <Icon>close</Icon>
                  </IconButton>
                    <Typography variant="h5" component="h2">{selectedPost.user}</Typography>
                    <Typography variant="body2" color="textSecondary">{selectedPost.date}</Typography>
                    <Typography variant="body1" paragraph>{selectedPost.content}</Typography>
                    <Button variant="contained" onClick={closeModal}>Close</Button>
                  </>
                )}
              </Box>
            </Fade>
          </Modal>
        </Box>
        </ThemeProvider>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
